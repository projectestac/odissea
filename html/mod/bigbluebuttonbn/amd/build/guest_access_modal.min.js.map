{"version":3,"file":"guest_access_modal.min.js","sources":["../src/guest_access_modal.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Javascript module for importing presets.\n *\n * @module      mod_bigbluebuttonbn/guest_access_modal\n * @copyright   2022 Blindside Networks Inc\n * @license     http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\nimport {get_string as getString} from 'core/str';\nimport ModalForm from 'core_form/modalform';\nimport {add as toastAdd, addToastRegion} from 'core/toast';\nimport {\n    exception as displayException,\n} from 'core/notification';\nconst selectors = {\n    showGuestAccessButton: '[data-action=\"show-guest-access\"]',\n};\n\n/**\n * Intialise the object and click event to show the popup form\n *\n * @param {object} guestInfo\n * @param {string} guestInfo.id\n * @param {string} guestInfo.groupid\n * @param {string} guestInfo.guestjoinurl\n * @param {string} guestInfo.guestpassword\n */\nexport const init = (guestInfo) => {\n    const showGuestAccessButton = document.querySelector(selectors.showGuestAccessButton);\n    if (showGuestAccessButton === null) {\n        return;\n    }\n\n    const modalForm = new ModalForm({\n        modalConfig: {\n            title: getString('guestaccess_title', 'mod_bigbluebuttonbn'),\n            large: true,\n        },\n        args: guestInfo,\n        saveButtonText: getString('ok', 'core_moodle'),\n        formClass: 'mod_bigbluebuttonbn\\\\form\\\\guest_add',\n    });\n    showGuestAccessButton.addEventListener('click', event => {\n        modalForm.show().then(() => {\n            addToastRegion(modalForm.modal.getRoot()[0]);\n            return true;\n        }).catch(displayException);\n        modalForm.addEventListener(modalForm.events.FORM_SUBMITTED, (e) => {\n            // Remove toast region as if not it will be displayed on the closed modal.\n            const modalElement = modalForm.modal.getRoot()[0];\n            const regions = modalElement.querySelectorAll('.toast-wrapper');\n            regions.forEach((reg) => reg.remove());\n            if (e.detail.result) {\n                if (e.detail.emailcount > 0) {\n                    toastAdd(getString('guestaccess_invite_success', 'mod_bigbluebuttonbn', e.detail),\n                        {\n                            type: 'success',\n                        }\n                    );\n                }\n            } else {\n                toastAdd(getString('guestaccess_invite_failure', 'mod_bigbluebuttonbn', e.detail),\n                    {\n                        type: 'warning',\n                    }\n                );\n            }\n        }, {once: true});\n        event.stopPropagation();\n    });\n};\n"],"names":["selectors","guestInfo","showGuestAccessButton","document","querySelector","modalForm","ModalForm","modalConfig","title","large","args","saveButtonText","formClass","addEventListener","event","show","then","modal","getRoot","catch","displayException","events","FORM_SUBMITTED","e","querySelectorAll","forEach","reg","remove","detail","result","emailcount","type","once","stopPropagation"],"mappings":";;;;;;;sJA4BMA,gCACqB,kDAYNC,kBACXC,sBAAwBC,SAASC,cAAcJ,oCACvB,OAA1BE,mCAIEG,UAAY,IAAIC,mBAAU,CAC5BC,YAAa,CACTC,OAAO,mBAAU,oBAAqB,uBACtCC,OAAO,GAEXC,KAAMT,UACNU,gBAAgB,mBAAU,KAAM,eAChCC,UAAW,yCAEfV,sBAAsBW,iBAAiB,SAASC,QAC5CT,UAAUU,OAAOC,MAAK,+BACHX,UAAUY,MAAMC,UAAU,KAClC,KACRC,MAAMC,yBACTf,UAAUQ,iBAAiBR,UAAUgB,OAAOC,gBAAiBC,IAEpClB,UAAUY,MAAMC,UAAU,GAClBM,iBAAiB,kBACtCC,SAASC,KAAQA,IAAIC,WACzBJ,EAAEK,OAAOC,OACLN,EAAEK,OAAOE,WAAa,mBACb,mBAAU,6BAA8B,sBAAuBP,EAAEK,QACtE,CACIG,KAAM,4BAKT,mBAAU,6BAA8B,sBAAuBR,EAAEK,QACtE,CACIG,KAAM,cAInB,CAACC,MAAM,IACVlB,MAAMmB"}