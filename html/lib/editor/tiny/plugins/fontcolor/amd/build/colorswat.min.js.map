{"version":3,"file":"colorswat.min.js","sources":["../src/colorswat.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Color palette setter for Tiny Font Color plugin.\n * This code is mostly reused from the TinyMCE silver theme. However, this\n * code is enhanced to have two different color maps for background and\n * text color. Also, the option to enable or disable custom colors\n * via a colorpicker can be set independently on both text- and\n * background color. If the colorpicker is disabled and the color\n * map is empty for one of the text- or background color, the menu entry as\n * well as the toolbar button will not appear in the editor.\n *\n * @module      tiny_fontcolor\n * @copyright   2023 Luca BÃ¶sch <luca.boesch@bfh.ch>\n * @copyright   2023 Stephan Robotta <stephan.robotta@bfh.ch>\n * @license     http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\n// ESLint directives.\n\nimport * as pf from './polyfill';\nimport {\n  getBackcolorMap,\n  getForecolorMap,\n  isBackcolorPickerOn,\n  isForecolorPickerOn,\n  useCssClasses,\n  getBackcolorClasses,\n  getForecolorClasses\n} from './options';\nimport {forecolor, backcolor} from './common';\nimport {isHexString, isNullable} from \"./polyfill\";\n\nlet global$4 = localStorage;\n\nconst map$2 = (xs, f) => {\n  const len = xs.length;\n  const r = new Array(len);\n  for (let i = 0; i < len; i++) {\n    const x = xs[i];\n    r[i] = f(x, i);\n  }\n  return r;\n};\n\nconst Label = () => {\n  let labels;\n  const register = txt => {\n    labels = txt;\n  };\n  const get = (name, ...args) => {\n    let val = !isNullable(labels[name]) ? labels[name] : name;\n    if (!isNullable(args)) {\n      for (let x = 0; x < args.length; x++) {\n        val = val.replace('{' + x + '}', args[x]);\n      }\n    }\n    return val;\n  };\n  return {\n    get,\n    register,\n  };\n};\n// eslint-disable-next-line\nconst labels = Label();\n\nconst Cell = initial => {\n  let value = initial;\n  const get = () => {\n    return value;\n  };\n  const set = v => {\n    value = v;\n  };\n  return {\n    get,\n    set\n  };\n};\n\nconst fireTextColorChange = (editor, data) => {\n  editor.dispatch('TextColorChange', data);\n};\n\nconst storageName = 'tinymce-custom-colors';\nconst ColorCache = (max = 10, suffix = '') => {\n  const storageString = global$4.getItem(storageName + suffix);\n  const localstorage = pf.isString(storageString) ? JSON.parse(storageString) : [];\n  const prune = list => {\n    const diff = max - list.length;\n    return diff < 0 ? list.slice(0, max) : list;\n  };\n  const cache = prune(localstorage);\n  const add = key => {\n    pf.indexOf(cache, key).each(remove);\n    cache.unshift(key);\n    if (cache.length > max) {\n      cache.pop();\n    }\n    global$4.setItem(storageName, JSON.stringify(cache));\n  };\n  const remove = idx => {\n    cache.splice(idx, 1);\n  };\n  const state = () => cache.slice(0);\n  return {\n    add,\n    state\n  };\n};\n\n// eslint-disable-next-line\nconst colorCache = ColorCache(10);\n// eslint-disable-next-line\nconst colorCacheBg = ColorCache(10, '-background');\n\nconst option$1 = name => editor => editor.options.get(name);\n\nconst getColorCols$1 = option$1('color_cols');\nconst getColors$3 = (editor, name) => {\n  if (name === forecolor) {\n    return getForecolorMap(editor);\n  }\n  return getBackcolorMap(editor);\n};\nconst getCurrentColors = (type) => map$2(type === forecolor ? colorCache.state() : colorCacheBg.state(), color => ({\n  type: 'choiceitem',\n  text: color,\n  value: color\n}));\nconst addColor = color => {\n  colorCache.add(color);\n};\n\nconst fallbackColor = '#000000';\nconst hasStyleApi = node => pf.isNonNullable(node.style);\nconst getCurrentColor = (editor, format) => {\n  let color;\n  editor.dom.getParents(editor.selection.getStart(), elm => {\n    const value = hasStyleApi(elm) ? elm.style[format === forecolor ? 'color' : 'backgroundColor'] : null;\n    if (value) {\n      color = color ? color : value;\n    }\n  });\n  return pf.Optional.from(color);\n};\nconst applyFormat = (editor, format, value) => {\n  editor.undoManager.transact(() => {\n    editor.focus();\n    editor.formatter.apply(format, {value});\n    editor.nodeChanged();\n  });\n};\nconst removeFormat = (editor, format) => {\n  editor.undoManager.transact(() => {\n    editor.focus();\n    editor.formatter.remove(format, {value: null}, undefined, true);\n    editor.nodeChanged();\n  });\n};\nconst registerLabels = txt => {\n    labels.register(txt);\n};\nconst registerCommands = editor => {\n  editor.addCommand('mceApplyTextcolor', (format, value) => {\n    applyFormat(editor, format, value);\n  });\n  editor.addCommand('mceRemoveTextcolor', format => {\n    removeFormat(editor, format);\n  });\n};\nconst handleColorChange = (editor, format, value) => {\n  if (useCssClasses(editor)) {\n    const cssClass = forecolor.includes(format)\n      ? getForecolorClasses(editor).find((v) => v[1] === value)\n      : getBackcolorClasses(editor).find((v) => v[1] === value);\n    if (cssClass) {\n      editor.execCommand('mceApplyTextcolor', 'fontcolor_classes', cssClass[0]);\n      return;\n    }\n  }\n  editor.execCommand('mceApplyTextcolor', format, value);\n};\nconst handleColorRemove = (editor, format) => {\n  if (useCssClasses(editor)) {\n    editor.execCommand('mceRemoveTextcolor', 'fontcolor_classes');\n    return;\n  }\n  editor.execCommand('mceRemoveTextcolor', format);\n};\nconst getAdditionalColors = hasCustom => {\n  const type = 'choiceitem';\n  const remove = {\n    type,\n    text: labels.get('removeColor'),\n    icon: 'color-swatch-remove-color',\n    value: 'remove'\n  };\n  const custom = {\n    type,\n    text: labels.get('customColor'),\n    icon: 'color-picker',\n    value: 'custom'\n  };\n  return hasCustom ? [\n    remove,\n    custom\n  ] : [remove];\n};\nconst applyColor = (editor, format, value, onChoice) => {\n  if (value === 'custom') {\n    const dialog = colorPickerDialog(editor);\n    dialog(colorOpt => {\n      colorOpt.each(color => {\n        addColor(color);\n        handleColorChange(editor, format, color);\n        onChoice(color);\n      });\n    }, fallbackColor);\n  } else if (value === 'remove') {\n    onChoice('');\n    handleColorRemove(editor, format);\n  } else {\n    onChoice(value);\n    handleColorChange(editor, format, value);\n  }\n};\nconst getColors$1 = (colors, hasCustom, type) => colors.concat(getCurrentColors(type).concat(getAdditionalColors(hasCustom)));\nconst getFetch$1 = (colors, hasCustom, type) => callback => {\n  callback(getColors$1(colors, hasCustom, type));\n};\nconst setIconColor = (splitButtonApi, name, newColor) => {\n  const id = name === forecolor ? 'tox-icon-text-color__color' : 'tox-icon-highlight-bg-color__color';\n  splitButtonApi.setIconFill(id, newColor);\n};\nconst registerTextColorButton = (editor, name, format, tooltip, lastColor) => {\n  let iconName, hasCustom;\n  if (name === forecolor) {\n    iconName = 'text-color';\n    hasCustom = isForecolorPickerOn(editor);\n  } else {\n    iconName = 'highlight-bg-color';\n    hasCustom = isBackcolorPickerOn(editor);\n  }\n  editor.ui.registry.addSplitButton(name, {\n    tooltip,\n    presets: 'color',\n    icon: iconName,\n    select: value => {\n      const optCurrentRgb = getCurrentColor(editor, format);\n      return optCurrentRgb.bind(currentRgb => pf.fromString(currentRgb).map(rgba => {\n        const currentHex = pf.fromRgba(rgba).value;\n        return pf.contains$1(value.toLowerCase(), currentHex);\n      })).getOr(false);\n    },\n    columns: getColorCols$1(editor),\n    fetch: getFetch$1(getColors$3(editor, name), hasCustom, name),\n    onAction: () => {\n      applyColor(editor, format, lastColor.get(), pf.noop);\n    },\n    onItemAction: (_splitButtonApi, value) => {\n      applyColor(editor, format, value, newColor => {\n        lastColor.set(newColor);\n        fireTextColorChange(editor, {\n          name,\n          color: newColor\n        });\n      });\n    },\n    onSetup: splitButtonApi => {\n      setIconColor(splitButtonApi, name, lastColor.get());\n      const handler = e => {\n        if (e.name === name) {\n          setIconColor(splitButtonApi, e.name, e.color);\n        }\n      };\n      editor.on('TextColorChange', handler);\n      return () => {\n        editor.off('TextColorChange', handler);\n      };\n    }\n  });\n};\nconst registerTextColorMenuItem = (editor, name, format, text) => {\n  editor.ui.registry.addNestedMenuItem(name, {\n    text,\n    icon: name === forecolor ? 'text-color' : 'highlight-bg-color',\n    getSubmenuItems: () => [{\n      type: 'fancymenuitem',\n      fancytype: 'colorswatch',\n      initData: {\n        allowCustomColors: name === forecolor ? isForecolorPickerOn(editor) : isBackcolorPickerOn(editor),\n        colors: getColors$3(editor, name),\n      },\n      onAction: data => {\n        applyColor(editor, format, data.value, pf.noop);\n      }\n    }]\n  });\n};\nconst colorPickerDialog = editor => (callback, value) => {\n  const onSubmit = api => {\n    const data = api.getData();\n    const hex = data.colorpicker;\n    const err = document.querySelector('.dlg-color-picker-error');\n    let isValid = true;\n    err.parentNode.parentNode.querySelectorAll('input').forEach((i, x) => {\n      if (x < 3) {\n        const m = ['R', 'G', 'B'];\n        const r = parseInt(i.value);\n        if (!i.value.match(/^\\d{1,3}$/) || r < 0 || r > 255) {\n          err.innerHTML = labels.get('colorPickerErrRgbCode', m[x] + ' = ' + i.value);\n          i.focus();\n          isValid = false;\n        }\n      } else if (!isHexString('#' + i.value)) {\n        err.innerHTML = labels.get('colorPickerErrHexCode', hex);\n        i.focus();\n        isValid = false;\n      }\n    });\n    if (isValid) {\n      callback(pf.Optional.from(hex));\n      api.close();\n    } else {\n      err.classList.remove('hidden');\n      err.classList.add('alert');\n    }\n  };\n  const initialData = {colorpicker: value};\n  editor.windowManager.open({\n    title: labels.get('colorPickerTitle'),\n    size: 'normal',\n    body: {\n      type: 'panel',\n      items: [{\n        type: 'htmlpanel',\n        html: '<span class=\"dlg-color-picker-error hidden\"></span>',\n      }, {\n        type: 'colorpicker',\n        name: 'colorpicker',\n        label: labels.get('colorPickerColor'),\n      }]\n    },\n    buttons: [\n      {\n        type: 'cancel',\n        name: 'cancel',\n        text: labels.get('colorPickerCancel'),\n      },\n      {\n        type: 'submit',\n        name: 'save',\n        text: labels.get('colorPickerSave'),\n        primary: true\n      }\n    ],\n    initialData,\n    onSubmit,\n    onClose: pf.noop,\n    onCancel: () => {\n      callback(pf.Optional.none());\n    }\n  });\n};\nconst register$c = (editor, txt) => {\n  if (!isForecolorPickerOn(editor) && !isBackcolorPickerOn(editor)\n    && getForecolorMap(editor).length === 0 && getBackcolorMap(editor).length === 0) {\n    return;\n  }\n  registerLabels(txt);\n  registerCommands(editor);\n  if (isForecolorPickerOn(editor) || getForecolorMap(editor).length > 0) {\n    // eslint-disable-next-line\n    const lastForeColor = Cell(fallbackColor);\n    registerTextColorButton(editor, forecolor, 'forecolor', labels.get('btnFgColor'), lastForeColor);\n    registerTextColorMenuItem(editor, forecolor, 'forecolor', labels.get('menuItemFgcolor'));\n  }\n  if (isBackcolorPickerOn(editor) || getBackcolorMap(editor).length > 0) {\n    // eslint-disable-next-line\n    const lastBackColor = Cell(fallbackColor);\n    registerTextColorButton(editor, backcolor, 'hilitecolor', labels.get('btnBgcolor'), lastBackColor);\n    registerTextColorMenuItem(editor, backcolor, 'hilitecolor', labels.get('menuItemBgcolor'));\n  }\n\n  // The css clases are is theme_<name>/scss are not present in the editor.\n  // Therefore, we must add manually our css classes for the color management.\n  if (useCssClasses(editor)) {\n    editor.on('SkinLoaded', () => {\n      editor.formatter.register('fontcolor_classes', {\n        inline: 'span',\n        attributes: {'class': '%value'},\n        links: true,\n        // eslint-disable-next-line camelcase\n        remove_similar: true,\n        // eslint-disable-next-line camelcase\n        clear_child_styles: true\n      });\n      const contentStyles = [];\n      getBackcolorClasses(editor).forEach((e) => {\n        contentStyles.push(`.${e[0]}{background-color:${e[1]}}`);\n      });\n      getForecolorClasses(editor).forEach((e) => {\n        contentStyles.push(`.${e[0]}{color: ${e[1]}}`);\n      });\n      // Append the css to the already existing css.\n      const mceDefaultStyles = editor.dom.select('#mceDefaultStyles');\n      if (mceDefaultStyles.length > 0) {\n        mceDefaultStyles[0].innerHTML += contentStyles.join(' ');\n      } else {\n        const styleEl = document.createElement('style');\n        styleEl.setAttribute('type', 'text/css');\n        const cssText = document.createTextNode(contentStyles.join(''));\n        styleEl.appendChild(cssText);\n        editor.dom.select('head')[0].appendChild(styleEl);\n      }\n    });\n  }\n};\n\nexport {\n  register$c,\n};\n"],"names":["global$4","localStorage","labels","get","name","val","args","x","length","replace","register","txt","Label","Cell","initial","value","set","v","storageName","ColorCache","max","suffix","storageString","getItem","localstorage","pf","isString","JSON","parse","prune","list","slice","cache","add","key","indexOf","each","remove","unshift","pop","setItem","stringify","idx","splice","state","colorCache","colorCacheBg","getColorCols$1","editor","options","getColors$3","forecolor","getCurrentColors","type","xs","f","len","r","Array","i","map$2","color","text","getCurrentColor","format","dom","getParents","selection","getStart","elm","node","isNonNullable","style","Optional","from","handleColorChange","cssClass","includes","find","execCommand","applyColor","onChoice","colorPickerDialog","dialog","colorOpt","addColor","handleColorRemove","getColors$1","colors","hasCustom","concat","icon","custom","getAdditionalColors","getFetch$1","callback","setIconColor","splitButtonApi","newColor","id","setIconFill","registerTextColorButton","tooltip","lastColor","iconName","ui","registry","addSplitButton","presets","select","bind","currentRgb","fromString","map","rgba","currentHex","fromRgba","contains$1","toLowerCase","getOr","columns","fetch","onAction","noop","onItemAction","_splitButtonApi","data","dispatch","fireTextColorChange","onSetup","handler","e","on","off","registerTextColorMenuItem","addNestedMenuItem","getSubmenuItems","fancytype","initData","allowCustomColors","initialData","colorpicker","windowManager","open","title","size","body","items","html","label","buttons","primary","onSubmit","api","hex","getData","err","document","querySelector","isValid","parentNode","querySelectorAll","forEach","m","parseInt","match","innerHTML","focus","close","classList","onClose","onCancel","none","registerLabels","addCommand","undoManager","transact","formatter","apply","nodeChanged","applyFormat","undefined","removeFormat","registerCommands","lastForeColor","lastBackColor","backcolor","inline","attributes","links","remove_similar","clear_child_styles","contentStyles","push","mceDefaultStyles","join","styleEl","createElement","setAttribute","cssText","createTextNode","appendChild"],"mappings":"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"}