{"version":3,"file":"configuration.min.js","sources":["../src/configuration.js"],"sourcesContent":["import {\n    imageButtonNameMathType,\n    imageButtonNameChemType\n} from './common';\nimport {\n    addMenubarItem,\n} from 'editor_tiny/utils';\n\n// Name of the default equation editor in Tiny\nconst TINY_EQUATION = 'tiny_equation';\n\nconst configureMenu = (menu) => {\n    if (menu.insert.items.includes(TINY_EQUATION)) {\n        // By Moodle's recommendation, we replace the default formula editor with MathType and ChemType\n        menu.insert.items = menu.insert.items.replace(TINY_EQUATION, `${imageButtonNameMathType} ${imageButtonNameChemType}`);\n    } else {\n        // If the default equation editor wasn't enabled, we just add MathType and ChemType\n        addMenubarItem(menu, 'insert', imageButtonNameMathType);\n        addMenubarItem(menu, 'insert', imageButtonNameChemType);\n    }\n\n    return menu;\n};\n\nconst configureToolbar = (toolbar) => {\n    // The toolbar contains an array of named sections.\n\n    // First, replace the default equation editor with MathType and ChemType\n    toolbar = toolbar.map((section) => {\n        const buttonIndex = section.items.indexOf(TINY_EQUATION);\n        if (buttonIndex > -1) {\n            section.items.splice(buttonIndex, 1, imageButtonNameMathType, imageButtonNameChemType);\n        }\n        return section;\n    });\n\n    // If the default editor had been removed from the toolbar, MT and CT will not have been included.\n    // In such case, add MathType and ChemType directly, in section `content`\n    const allButtons = toolbar.flatMap((section) => section.items);\n    const hasMathType = allButtons.includes(imageButtonNameMathType);\n    const hasChemType = allButtons.includes(imageButtonNameChemType);\n    if (!hasMathType || !hasChemType) {\n        toolbar = toolbar.map((section) => {\n            if (section.name === 'content') {\n                if (!hasMathType) {\n                    section.items.unshift(imageButtonNameChemType);\n                }\n                if (!hasChemType) {\n                    section.items.unshift(imageButtonNameMathType);\n                }\n            }\n            return section;\n        });\n    }\n\n    return toolbar;\n};\n\nexport const configure = (instanceConfig) => {\n    // Update the instance configuration to add the Media menu option to the menus and toolbars and upload_handler.\n    return {\n        toolbar: configureToolbar(instanceConfig.toolbar),\n        menu: configureMenu(instanceConfig.menu),\n    };\n};\n"],"names":["configureToolbar","toolbar","allButtons","map","section","buttonIndex","items","indexOf","splice","imageButtonNameMathType","imageButtonNameChemType","flatMap","hasMathType","includes","hasChemType","name","unshift","instanceConfig","menu","insert","replace"],"mappings":"wMAwBMA,iBAAoBC,gBAchBC,YAVND,QAAUA,QAAQE,KAAKC,gBACbC,YAAcD,QAAQE,MAAMC,QApBpB,wBAqBVF,aAAe,GACfD,QAAQE,MAAME,OAAOH,YAAa,EAAGI,gCAAyBC,iCAE3DN,YAKgBO,SAASP,SAAYA,QAAQE,QAClDM,YAAcV,WAAWW,SAASJ,iCAClCK,YAAcZ,WAAWW,SAASH,wCACnCE,aAAgBE,cACjBb,QAAUA,QAAQE,KAAKC,UACE,YAAjBA,QAAQW,OACHH,aACDR,QAAQE,MAAMU,QAAQN,iCAErBI,aACDV,QAAQE,MAAMU,QAAQP,kCAGvBL,YAIRH,4BAGegB,uBAEf,CACHhB,QAASD,iBAAiBiB,eAAehB,SACzCiB,MAnDeA,KAmDKD,eAAeC,KAlDnCA,KAAKC,OAAOb,MAAMO,SAHJ,iBAKdK,KAAKC,OAAOb,MAAQY,KAAKC,OAAOb,MAAMc,QALxB,0BAKkDX,4CAA2BC,6DAG5EQ,KAAM,SAAUT,2DAChBS,KAAM,SAAUR,kCAG5BQ,OAVYA,IAAAA"}